{% extends "container.html" %}
{% block html %}
{% if thesis %}
<div class="container">
    <div class="row align-items-center">

        <h1 id="position" class="">
    </div>

    <div class="row align-items-center">
        <div class="col-10">

            <h3 class="justify-content-center">Th√®se ou pipo ?</h3>
            <div class="col-md-offset-2">
                <div class="row justify-content-around">
                    <div class="col-md-4">
                        <button id="yes" class="btn btn-success">These</button>
                    </div>
                    <div class="col-md-4">
                        <button id="no" class="btn btn-danger">Pipo</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
    
    
        <img id="img-no" src='{{url_for("static", filename="img/no.jpg" )}}' alt="centered image"
            class="hidden marginauto">
        <img id="img-yes" src='{{url_for("static", filename="img/yes.gif" )}}' alt="centered image"
            class="hidden marginauto">
    
    
</div>
{% endif %}
{% endblock %}
{% block js %}
<script>
    const thesis = [
        {% for these in thesis %}
    {
        title: "{{ these.title }}",
            id: "{{ these.thesisid }}",
                isTrue: "{{ these.isTrue }}"
    },
    {% endfor %}
        ];

    const getRandomThese = () => {
        return thesis[Math.floor(Math.random() * thesis.length)]
    };

    const getData = isRight => {
        const these = $("#these");
        return {
            id: these.attr("data-id"),
            isRight: isRight,
            isReal: these.attr("isTrue")
        }
    }

    const sendData = isRight => {
        $.ajax({
            url: "/stat",
            type: "POST",
            data: JSON.stringify(getData(isRight)),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: () => { }
        });
    };

    const isItTrue = () => $("#these").attr("isTrue") === "True";
    const displayGif = isTrue => {
        if (isTrue) {
            $("#img-yes").removeClass("hidden");
            $("#img-no").addClass("hidden");
        } else {
            $("#img-no").removeClass("hidden");
            $("#img-yes").addClass("hidden");
        }
    }

    $(document).ready(function () {
        const these = getRandomThese();
        $("#position").html(`<span id="these" data-id="${these.id}" isTrue="${these.isTrue}">${these.title}</span>`);
    });

    $("#no").click(e => {
        e.preventDefault();
        displayGif(!isItTrue());
        sendData(isItTrue())
    });
    $("#yes").click(e => {
        e.preventDefault();
        displayGif(isItTrue());
        sendData(isItTrue())
    });
</script>
{% endblock %}